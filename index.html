<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            margin: 0;
            overflow-x: clip; /* Clip au lieu de hidden pour permettre débordement interne */

        }

        /* Conteneur */
        .horizontal-container {
            width: 100vw;
            height: 100vh;
            overflow: visible;
            background-color: #FFA6C9; /* Fond rose révélé quand éléments partent */
        }

        .parallaxe {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow-x: visible; /* Permet débordement horizontal */
            overflow-y: hidden; /* Cache débordement vertical (jambes people) */
            flex-shrink: 0; /* Empêche la compression */
        }

        .parallaxe img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        #texte {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 50; /* Entre fond et people, assez haut pour déborder */
        }

        .parallaxe div {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            display: flex;
            justify-content: center;
        }

        .parallaxe div img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 100; /* Z-index très élevé pour déborder sur .horizontal */
            position: relative; /* Nécessaire pour que z-index fonctionne */
        }

        h1 {
            position: absolute;
            top: 30%;
            left: 48%;
            color: black;
            font-size: 4rem;
            font-family: Arial, sans-serif;
            margin: 0;
            width: 5vw;
        }

        span{
            font-size: 2rem;
            font-family: Arial, sans-serif;
            text-transform: uppercase;
            margin: 0;
        }

        article {
            width: 100vw;
            height: 100vh;
        }

    </style>
</head>

<body>
    <article>

    </article>

    <div class="horizontal-container">
        <section class="parallaxe">
            <img id="fond" src="fond_parallaxe.png" alt="">
            <img id="texte" src="texte-parallaxe.png" alt="">
            <div>
                <img id="people" src="people_parallaxe.png" alt="">
            </div>
        </section>
    </div>

    <article></article>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollTrigger.min.js"></script>

    <script>
        gsap.registerPlugin(ScrollTrigger);

        // DÉTECTION RESPONSIVE
        const isMobile = window.innerWidth < 768;
        const isTablet = window.innerWidth >= 768 && window.innerWidth < 1024;

        // VALEURS ADAPTATIVES SELON LA TAILLE D'ÉCRAN
        // Scale values
        const peopleScale = isMobile ? 3 : (isTablet ? 4 : 5);
        const texteScale = isMobile ? 1.3 : (isTablet ? 1.5 : 1.65);
        const fondScale = isMobile ? 1.1 : 1.2;

        // Scroll duration
        const scrollDuration = isMobile ? "+=300%" : (isTablet ? "+=400%" : "+=500%");

        // Animation durations
        const peopleDuration = isMobile ? 10 : 12;
        const texteDuration = isMobile ? 6 : 8;
        const fondDuration = isMobile ? 8 : 10;
        const fondExitDuration = isMobile ? 6 : 8;
        const peopleExitDuration = isMobile ? 5 : 6;

        // Mouvement horizontal initial (Phase 1)
        const initialXMove = isMobile ? "0%" : "-10%"; // Mobile: centré, Desktop: légèrement à gauche

        // Exit distances
        const fondExitX = isMobile ? "-130%" : "-150%";
        const peopleExitX = isMobile ? "-160%" : "-180%"; // Mobile: plus loin pour bien disparaître

        // Timeline: ZOOM PARALLAXE + SCROLL HORIZONTAL
        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: ".horizontal-container",
                start: "top top",
                end: scrollDuration,
                scrub: 1,
                pin: true,
                markers: true
            }
        });

        // PHASE 1: ZOOM PARALLAXE - People d'abord, puis fond et texte
        // 1) People zoom (commence immédiatement)
        tl.to("#people", {
            scale: peopleScale,
            x: initialXMove,
            duration: peopleDuration,
            ease: "power2.inOut"
        }, 0)

        // 2) Fond zoom (commence à mi-parcours de people)
        .to("#fond", {
            scale: fondScale,
            x: initialXMove,
            duration: fondDuration,
            ease: "power1.inOut"
        }, 3)

        // 3) Texte zoom (commence en même temps que fond)
        .to("#texte", {
            scale: texteScale,
            x: initialXMove,
            duration: texteDuration,
            ease: "power1.inOut"
        }, 3)

        // PHASE 2: FOND ET PEOPLE DISPARAISSENT (texte reste statique)
        // Fond part vers la gauche
        .to("#fond", {
            x: fondExitX,
            duration: fondExitDuration,
            ease: "power1.in"
        }, 12)

        // People part vers la gauche (encore plus loin pour ne plus être visible)
        .to("#people", {
            x: peopleExitX,
            duration: peopleExitDuration,
            ease: "power2.in"
        }, 12);

        // REFRESH SCROLLTRIGGER SUR RESIZE (avec debounce)
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                ScrollTrigger.refresh();
            }, 250);
        });

    </script>
</body>

</html>